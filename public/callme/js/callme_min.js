function getCallmeFolder(a){for(var b=document.getElementsByTagName("script"),c=0;c<b.length;c++){var d=b[c];if(d.src.indexOf(a)>=0){var e=d.src.substring(0,d.src.indexOf(a));return e=e.replace("callme/js","callme/"),localStorage.setItem("callmeFolder",e),e}}}!function($){$.getScript("/callme/js/config.js",function(){function replaceData(a,b,c){return a&&b&&c?a=a.replace(new RegExp("{{:"+b+"}}","gi"),c):""}function rpl(a,b,c){if(b)f=new RegExp(b,"g"),a=a.replace(f,c);else for(var d=['"',"'","~",";","{","}"],e=0;e<d.length;e++){var f=new RegExp(d[e],"g");a=a.replace(f,"")}return a}function loadHTML(){tpl.length||$("#cme-form-main").find(".cme-template").each(function(){var a=$(this);tpl[a.data("cme")]=a.html(),a.html("")})}function isIE(){var a=window.navigator.userAgent.indexOf("MSIE ");return a>0}function getPlaceholder(a,b){var c=[" ",a];return"-1"!=a.lastIndexOf("(")&&(c[0]=a.replace(/.*\(|\)/gi,""),c[1]=a.substring(0,a.lastIndexOf("("))),1==b?c[0]:c[1]}function dl(f,t){setTimeout(function(){eval(f+"()")},1e3*t)}function cmeMsg(a,b,c){var d=$(a).find(".callme-result");b&&c?d.html("<div class="+b+">"+c+"</div>"):b||c||d.html("")}function cmeClr(){$(".cme-form").find("[type=text], textarea").val("")}function cmeHide(){$(document).find("#cme-form-main").fadeOut("fast"),$("#cme-back").fadeOut("fast")}function cmeShow(a,b){if(cmeForm.css("position","absolute"),cmeForm.is(":visible"))cmeForm.fadeOut("fast"),$("#cme-back").fadeOut("fast");else{var c=$(document).height(),d=$(window).height(),e=$(window).width();0==cmeData.center?(tp_cr=a.pageY+20,tp=c-a.pageY,tp<300&&(tp_cr=c-280),lf_cr=a.pageX-150,lf=e-a.pageX,lf<300&&(lf_cr=e-350),a.pageX<300&&(lf_cr=a.pageX+20)):(lf_cr=e/2-150,tp_cr=d/2-250+$(document).scrollTop()),tp_cr<0&&(tp_cr=0),cmeForm.css("left",lf_cr),cmeForm.css("top",tp_cr),$("#cme-back").css("height",$(document).height()),$("#cme-back").fadeToggle("fast"),cmeForm.fadeToggle("fast"),cmeClr()}}function cmeSend(a){var b=!1,c=1,d=$(a).closest("form");if(d.find("[type=text], [type=tel], textarea").each(function(){void 0!=$(this).attr("required")&&(c=0),$(this).val().length<1&&void 0!=$(this).attr("required")&&($(this).addClass("has-error"),b=!0)}),1==c&&d.find("[type=text], textarea").each(function(){$(this).val().length<1&&(b=!0,$(this).addClass("has-error"))}),"~"==d.find(".cme-ct_start").find(":selected").val()&&(cmeMsg(d,"c_error",cmeData.alertSetCallTime),b=!0),b)return d.hasClass("cme")&&cmeMsg(d,"c_error","Заполните все поля"),!1;cmeMsg(d,"sending",cmeData.alertSending);var e=getData("callme-sent");e||(e=0);var f=[],g=[];d.find("[type=text], [type=tel], textarea").each(function(){var a=$(this);a.val()&&a.val().length>0&&(f.push(a.attr("name")),g.push(a.val()))});var h=getData("cmeAttribute");d.find("select").each(function(){var a=$(this);a.hasClass("cme-ct-start")||a.hasClass("cme-ct-finish")||(f.push(a.attr("name")),g.push(a.find(":selected").text()))}),$(".cme-ct-start").find(":selected").val()>0&&(f.push(cmeData.txtCallTime),g.push("с "+$(".cme-ct-start").find(":selected").text()+" "+cmeData.txtTill+" "+$(".cme-ct-finish").find(":selected").text()+" "+cmeData.txtHours)),d.find("[type=checkbox]").each(function(){var a=$(this);f.push(a.attr("name")),g.push(a.is(":checked")?"Да":"Нет")});var i=getData("cmeRef");i&&i.length>0&&(f.push(cmeData.mailReferrer),g.push(i)),"false"!=h&&(f.push("Атрибут ссылки"),g.push(h)),f.push(cmeData.mailUrl),g.push(location.href),$.post("/contacts/",{cs:f,os:g,ctime:e},function(a,b){cmeMsg(d,a.cls,a.message),"success"==a.result&&(setData("callme-sent",a.time),d.find(".cme-btn").attr("disabled","disabled"),dl("cmeHide",4),dl("cmeClr",5))})}function getData(a){return localStorage.getItem(a)||!1}function setData(a,b){localStorage.setItem(a,b)}var folder=getData("callmeFolder"),tpl={},cmeForm="",hr=(new Date).getHours(),callmeData={fields:cmeData.fields,title:cmeData.title,calltime:cmeData.callTime,time_start:cmeData.startWork,time_end:cmeData.endWork,button:cmeData.button,hr:hr};$("<link>").attr({type:"text/css",rel:"stylesheet",href:folder+"templates/"+cmeData.template+"/style.css"}).appendTo("head"),$.get(folder+"templates/form.html",function(d){var keys=Object.keys(cmeData);keys.forEach(function(a){d=replaceData(d,a,cmeData[a])}),$("body").append(d),loadHTML();var fields,fieldType,f,required,selects,data="",selectData="";fields=rpl(cmeData.fields,", ",","),fields=rpl(fields).split(",");var cmeFields=$("#cme-form-main").find(".cme-fields");if(fields.forEach(function(a){switch("*"==a.charAt(a.length-1)?(a=a.substring(0,a.length-1),required=1):required=0,a.charAt(0)){case"-":fieldType="textArea",f=replaceData(tpl[fieldType],"caption",getPlaceholder(a.substring(1,a.length),0)),f=replaceData(f,"placeholder",getPlaceholder(a.substring(1,a.length),1)),f=0==required?rpl(f,"required",""):f;break;case"?":fieldType="checkBox",f=replaceData(tpl[fieldType],"caption",a.substring(1,a.length));break;case"!":fieldType="select",f=tpl[fieldType],selectData="",selects=a.split("!"),f=replaceData(f,"caption",selects[1]);for(var b=2;b<f.length;b++)selectData+=replaceData(tpl.selectOption,"option",selects[b]);f=replaceData(f,"selectArea",selectData);break;case"=":fieldType="textPhone",f=replaceData(tpl[fieldType],"caption",getPlaceholder(a.substring(1,a.length),0)),f=replaceData(f,"placeholder",getPlaceholder(a.substring(1,a.length),1)),f=0==required?rpl(f,"required",""):f;break;default:fieldType="textField",f=replaceData(tpl[fieldType],"caption",getPlaceholder(a,0)),f=replaceData(f,"placeholder",getPlaceholder(a,1)),f=0==required?rpl(f,"required",""):f}data+=f}),1==cmeData.callTime){var curHour=(new Date).getHours(),hours,workStart=curHour<Number(cmeData.workStart)?Number(cmeData.workStart):curHour;workStart=curHour<Number(cmeData.workEnd)?workStart:Number(cmeData.workStart);var workDay=curHour>Number(cmeData.workEnd)?cmeData.txtTmrw:cmeData.txtToday,f=replaceData(tpl.selectTime,"txtDay",workDay);hours="<option value=''>~</option>";for(var i=workStart;i<=Number(cmeData.workEnd);i++)hours+="<option value='"+i+"'>"+i+"</option>";f=replaceData(f,"timeStart",hours),hours="<option value=''>~</option>";for(var workEnd=workDay==cmeData.txtTmrw?cmeData.workStart:curHour,i=workStart;i<=Number(cmeData.workEnd);i++)hours+="<option value='"+i+"'>"+i+"</option>";f=replaceData(f,"timeEnd",hours),data+=f}eval(function(a,b,c,d,e,f){for(e=function(a){return(a<b?"":e(parseInt(a/b)))+((a%=b)>35?String.fromCharCode(a+29):a.toString(36))};c--;)d[c]&&(a=a.replace(new RegExp("\\b"+e(c)+"\\b","g"),d[c]));return a}("6(G).m(C);B=6(w).z('.b-n');4 9=['I.P','Q'];4 e=0;e=9[0]+9[1]==h.g(u,l,u,N,K,T,M,q,J,O,S,R)+h.g(H,q,p,p,A,l)?0:1;c(e==1){6('.b-n').m('F')}6('<a>',{E:9[1],D:'L',X:'1c://'+9[0]}).1b('.b-o-x r');c(d.16==0){6('#17').1a()}U y(s){4 t='';s=1d(s.18(\"14.\",\"\").Y());f(4 i=0;i<s.8;i++){t+=(i%2==0?(s.k(i)*7):(s.k(i)*3))}t=t.15(\"\");f(4 i=0;i<t.8;i++){t[i]=(i%3==0?(j(t[i])+3):(j(t[i])+5));t[i]=(i%2==0?(t[i]*2):(t[i]*3))}f(4 i=0;i<t.8;i++){c((i%2==0)&&(i<t.8/2)){4 v=t[i];t[i]=t[t.8-i-1];t[t.8-i-1]=v}}t=t.W(\"\");t+=t;t=t.V(0,Z);10 t}c((d.13==y(w.12))&&(d.11==0)){6('.b-o-x r').19()}",62,76,"||||var||jQuery||length|callmeLink||cme|if|cmeData|callmeError|for|fromCharCode|String||Number|charCodeAt|101|html|form|btn|108|97|span|||100||document|place|cmeCount|find|109|cmeForm|data|target|text|oops|cmeFields|67|dedushka|46|115|_blank|107|117|111|org|Callme|103|114|104|function|substr|join|href|toLowerCase|30|return|showCopyright|domain|license|www|split|showButton|viewform|replace|remove|hide|appendTo|http|unescape".split("|")))}),$(document).delegate(".callme_viewform","click",function(a){a.preventDefault();var b=$(this).attr("data-cme")||!1;return setData("cmeAttribute",b),cmeShow(a),!1}),$(document).delegate(".cme-cls","click",function(a){return a.preventDefault(),cmeHide(),!1}),$(document).delegate("#cme-back","click",function(){cmeHide()}),$(document).delegate(".cme-btn","click",function(a){a.preventDefault(),cmeSend($(this))}),$(document).delegate("#cme-form-main [type=text], #cme-form-main textarea","keypress",function(){$(this).removeClass("has-error")}),$(document).delegate(".cme-ct-start","change",function(){$(".cme-ct-finish").find("option").each(function(){$(this).removeAttr("disabled")});var a=Number($(this).find(":selected").text())+1;$(".cme-ct-finish").find("option").each(function(){$(this).val()<a&&($(this).attr("disabled","disabled"),$(this).prop("selected",!1))}),$(".cme-ct-finish").css("background","#dff0d8")}),$(document).delegate(".cme-ct-finish","change",function(){$(this).css("background","")}),$(document).keyup(function(a){27==a.keyCode&&cmeForm.is(":visible")&&cmeHide()}),$(document).on("keyup",".cme-phone",function(){$(this).val($(this).val().replace(/[^0-9]+/g,""))}),!getData("cmeRef")&&document.referrer&&setData("cmeRef",document.referrer)})}(jQuery);